Feature: OSCAL Document Constraints

@style-guide
Scenario Outline: Validating OSCAL constraints with metaschema constraints
  Then I should verify that all constraints follow the style guide constraint

@integration
Scenario Outline: Documents that should be valid are pass
  Given I have loaded all Metaschema extensions documents
  Then I should have valid results "<valid_file>"
Examples:
| valid_file     |
| ../../../content/rev5/examples/ssp/xml/fedramp-ssp-example.oscal.xml |

@full-coverage
Scenario: Preparing constraint coverage analysis
Given I have loaded all Metaschema extensions documents
And I have collected all YAML test files in the test directory
When I extract all constraint IDs from the Metaschema extensions
And I analyze the YAML test files for each constraint ID

@full-coverage
Scenario Outline: Ensuring full test coverage for "<constraint_id>"
Then I should have both FAIL and PASS tests for constraint ID "<constraint_id>"
Examples:
| constraint_id |
#BEGIN_DYNAMIC_CONSTRAINT_IDS
  | frr121 |
  | frr122 |
  | frr123 |
  | frr124 |
  | frr125 |
  | frr126 |
  | frr127 |
  | frr128 |
  | frr129 |
  | frr130 |
  | frr131 |
  | frr132 |
  | frr133 |
  | frr134 |
  | frr135 |
  | frr136 |
  | frr137 |
  | frr138 |
  | frr139 |
  | frr140 |
  | frr141 |
  | frr142 |
  | frr143 |
  | frr144 |
  | frr145 |
  | frr146 |
  | frr147 |
  | frr148 |
  | frr149 |
  | frr150 |
  | frr151 |
  | frr152 |
  | frr153 |
  | frr154 |
  | frr155 |
  | frr156 |
  | frr157 |
  | frr158 |
  | frr159 |
  | frr160 |
  | frr161 |
  | frr162 |
  | frr163 |
  | frr164 |
  | frr165 |
  | frr166 |
  | frr167 |
  | frr168 |
  | frr169 |
  | frr170 |
  | frr171 |
  | frr172 |
  | frr173 |
  | frr174 |
  | frr175 |
  | frr176 |
  | frr177 |
  | frr178 |
  | frr179 |
  | frr180 |
  | frr181 |
  | frr182 |
  | frr183 |
  | frr184 |
  | frr185 |
  | frr186 |
  | frr187 |
  | frr188 |
  | frr189 |
  | frr190 |
  | frr191 |
  | frr192 |
  | frr193 |
  | frr194 |
  | frr195 |
  | frr196 |
  | frr197 |
  | frr198 |
  | frr199 |
  | frr200 |
  | frr201 |
  | frr202 |
  | frr203 |
  | frr204 |
  | frr205 |
  | frr206 |
  | frr207 |
  | frr208 |
  | frr209 |
  | frr210 |
  | frr211 |
  | frr212 |
  | frr213 |
  | frr214 |
  | frr215 |
  | frr216 |
  | frr217 |
  | frr218 |
  | frr219 |
  | frr220 |
  | frr221 |
  | frr222 |
  | frr223 |
  | frr224 |
  | frr225 |
  | frr226 |
  | frr227 |
  | frr228 |
  | frr229 |
  | frr230 |
  | frr231 |
  | frr232 |
  | frr233 |
  | frr234 |
  | frr235 |
  | frr236 |
  | frr237 |
  | frr238 |
  | frr239 |
  | frr240 |
  | frr241 |
  | frr242 |
  | frr243 |
  | frr244 |
  | frr245 |
  | frr246 |
  | frr247 |
  | frr248 |
  | frr249 |
  | frr250 |
  | frr251 |
  | frr252 |
  | frr253 |
  | frr254 |
  | frr255 |
  | frr256 |
  | frr257 |
  | frr258 |
  | frr259 |
  | frr260 |
  | frr261 |
  | frr262 |
  | frr263 |
  | frr264 |
  | frr265 |
  | frr266 |
  | frr267 |
  | frr268 |
  | frr269 |
  | frr270 |
  | frr271 |
  | frr272 |
  | frr273 |
  | frr274 |
  | frr275 |
  | frr276 |
  | frr277 |
  | frr278 |
  | frr279 |
  | frr280 |
  | frr281 |
  | frr282 |
  | frr283 |
  | frr284 |
  | frr285 |
  | frr286 |
  | frr287 |
  | frr288 |
  | frr289 |
  | frr290 |
  | frr291 |
  | frr292 |
  | frr293 |
  | frr294 |
  | frr296 |
  | frr297 |
  | frr298 |
  | frr299 |
  | frr300 |
  | frr301 |
  | frr302 |
  | frr303 |
  | frr304 |
  | frr305 |
  | frr306 |
  | frr307 |
#END_DYNAMIC_CONSTRAINT_IDS

@constraints
Scenario Outline: Validating OSCAL documents with metaschema constraints
  Given I have Metaschema extensions documents
    | filename                           |
#BEGIN_DYNAMIC_CONSTRAINT_FILES
  | fedramp-external-allowed-values.xml |
  | fedramp-external-constraints.xml |
  | oscal-external-constraints.xml |
#END_DYNAMIC_CONSTRAINT_FILES
  When I process the constraint unit test "<test_file>"
  Then the constraint unit test should pass

Examples:
  | test_file |
#BEGIN_DYNAMIC_TEST_CASES
  | frr121-FAIL.yaml |
  | frr121-PASS.yaml |
  | frr122-FAIL.yaml |
  | frr122-PASS.yaml |
  | frr123-FAIL.yaml |
  | frr123-PASS.yaml |
  | frr124-FAIL.yaml |
  | frr124-PASS.yaml |
  | frr125-FAIL.yaml |
  | frr125-PASS.yaml |
  | frr126-FAIL.yaml |
  | frr126-PASS.yaml |
  | frr127-FAIL.yaml |
  | frr127-PASS.yaml |
  | frr128-FAIL.yaml |
  | frr128-PASS.yaml |
  | frr129-FAIL.yaml |
  | frr129-PASS.yaml |
  | frr130-FAIL.yaml |
  | frr130-PASS.yaml |
  | frr131-FAIL.yaml |
  | frr131-PASS.yaml |
  | frr132-FAIL.yaml |
  | frr132-PASS.yaml |
  | frr133-FAIL.yaml |
  | frr133-PASS.yaml |
  | frr134-FAIL.yaml |
  | frr134-PASS.yaml |
  | frr135-FAIL.yaml |
  | frr135-PASS.yaml |
  | frr136-FAIL.yaml |
  | frr136-PASS.yaml |
  | frr137-FAIL.yaml |
  | frr137-PASS.yaml |
  | frr138-FAIL.yaml |
  | frr138-PASS.yaml |
  | frr139-FAIL.yaml |
  | frr139-PASS.yaml |
  | frr140-FAIL.yaml |
  | frr140-PASS.yaml |
  | frr141-FAIL.yaml |
  | frr141-PASS.yaml |
  | frr142-FAIL.yaml |
  | frr142-PASS.yaml |
  | frr143-FAIL.yaml |
  | frr143-PASS.yaml |
  | frr144-FAIL.yaml |
  | frr144-PASS.yaml |
  | frr145-FAIL.yaml |
  | frr145-PASS.yaml |
  | frr146-FAIL.yaml |
  | frr146-PASS.yaml |
  | frr147-FAIL.yaml |
  | frr147-PASS.yaml |
  | frr148-FAIL.yaml |
  | frr148-PASS.yaml |
  | frr149-FAIL.yaml |
  | frr149-PASS.yaml |
  | frr150-FAIL.yaml |
  | frr150-PASS.yaml |
  | frr151-FAIL.yaml |
  | frr151-PASS.yaml |
  | frr152-FAIL.yaml |
  | frr152-PASS.yaml |
  | frr153-FAIL.yaml |
  | frr153-PASS.yaml |
  | frr154-FAIL.yaml |
  | frr154-PASS.yaml |
  | frr155-FAIL.yaml |
  | frr155-PASS.yaml |
  | frr156-FAIL.yaml |
  | frr156-PASS.yaml |
  | frr157-FAIL.yaml |
  | frr157-PASS.yaml |
  | frr158-FAIL.yaml |
  | frr158-PASS.yaml |
  | frr159-FAIL.yaml |
  | frr159-PASS.yaml |
  | frr160-FAIL.yaml |
  | frr160-PASS.yaml |
  | frr161-FAIL.yaml |
  | frr161-PASS.yaml |
  | frr162-FAIL.yaml |
  | frr162-PASS.yaml |
  | frr163-FAIL.yaml |
  | frr163-PASS.yaml |
  | frr164-FAIL.yaml |
  | frr164-PASS.yaml |
  | frr165-FAIL.yaml |
  | frr165-PASS.yaml |
  | frr166-FAIL.yaml |
  | frr166-PASS.yaml |
  | frr167-FAIL.yaml |
  | frr167-PASS.yaml |
  | frr168-FAIL.yaml |
  | frr168-PASS.yaml |
  | frr169-FAIL.yaml |
  | frr169-PASS.yaml |
  | frr170-FAIL.yaml |
  | frr170-PASS.yaml |
  | frr171-FAIL.yaml |
  | frr171-PASS.yaml |
  | frr172-FAIL.yaml |
  | frr172-PASS.yaml |
  | frr173-FAIL.yaml |
  | frr173-PASS.yaml |
  | frr174-FAIL.yaml |
  | frr174-PASS.yaml |
  | frr175-FAIL.yaml |
  | frr175-PASS.yaml |
  | frr176-FAIL.yaml |
  | frr176-PASS.yaml |
  | frr177-FAIL.yaml |
  | frr177-PASS.yaml |
  | frr178-FAIL.yaml |
  | frr178-PASS.yaml |
  | frr179-FAIL.yaml |
  | frr179-PASS.yaml |
  | frr180-FAIL.yaml |
  | frr180-PASS.yaml |
  | frr181-FAIL.yaml |
  | frr181-PASS.yaml |
  | frr182-FAIL.yaml |
  | frr182-PASS.yaml |
  | frr183-FAIL.yaml |
  | frr183-PASS.yaml |
  | frr184-FAIL.yaml |
  | frr184-PASS.yaml |
  | frr185-FAIL.yaml |
  | frr185-PASS.yaml |
  | frr186-FAIL.yaml |
  | frr186-PASS.yaml |
  | frr187-FAIL.yaml |
  | frr187-PASS.yaml |
  | frr188-FAIL.yaml |
  | frr188-PASS.yaml |
  | frr189-FAIL.yaml |
  | frr189-PASS.yaml |
  | frr190-FAIL.yaml |
  | frr190-PASS.yaml |
  | frr191-FAIL.yaml |
  | frr191-PASS.yaml |
  | frr192-FAIL.yaml |
  | frr192-PASS.yaml |
  | frr193-FAIL.yaml |
  | frr193-PASS.yaml |
  | frr194-FAIL.yaml |
  | frr194-PASS.yaml |
  | frr195-FAIL.yaml |
  | frr195-PASS.yaml |
  | frr196-FAIL.yaml |
  | frr196-PASS.yaml |
  | frr197-FAIL.yaml |
  | frr197-PASS.yaml |
  | frr198-FAIL.yaml |
  | frr198-PASS.yaml |
  | frr199-FAIL.yaml |
  | frr199-PASS.yaml |
  | frr200-FAIL.yaml |
  | frr200-PASS.yaml |
  | frr201-FAIL.yaml |
  | frr201-PASS.yaml |
  | frr202-FAIL.yaml |
  | frr202-PASS.yaml |
  | frr203-FAIL.yaml |
  | frr203-PASS.yaml |
  | frr204-FAIL.yaml |
  | frr204-PASS.yaml |
  | frr205-FAIL.yaml |
  | frr205-PASS.yaml |
  | frr206-FAIL.yaml |
  | frr206-PASS.yaml |
  | frr207-FAIL.yaml |
  | frr207-PASS.yaml |
  | frr208-FAIL.yaml |
  | frr208-PASS.yaml |
  | frr209-FAIL.yaml |
  | frr209-PASS.yaml |
  | frr210-FAIL.yaml |
  | frr210-PASS.yaml |
  | frr211-FAIL.yaml |
  | frr211-PASS.yaml |
  | frr212-FAIL.yaml |
  | frr212-PASS.yaml |
  | frr213-FAIL.yaml |
  | frr213-PASS.yaml |
  | frr214-FAIL.yaml |
  | frr214-PASS.yaml |
  | frr215-FAIL.yaml |
  | frr215-PASS.yaml |
  | frr216-FAIL.yaml |
  | frr216-PASS.yaml |
  | frr217-FAIL.yaml |
  | frr217-PASS.yaml |
  | frr218-FAIL.yaml |
  | frr218-PASS.yaml |
  | frr219-FAIL.yaml |
  | frr219-PASS.yaml |
  | frr220-FAIL.yaml |
  | frr220-PASS.yaml |
  | frr221-FAIL.yaml |
  | frr221-PASS.yaml |
  | frr222-FAIL.yaml |
  | frr222-PASS.yaml |
  | frr223-FAIL.yaml |
  | frr223-PASS.yaml |
  | frr224-FAIL.yaml |
  | frr224-PASS.yaml |
  | frr225-FAIL.yaml |
  | frr225-PASS.yaml |
  | frr226-FAIL.yaml |
  | frr226-PASS.yaml |
  | frr227-FAIL.yaml |
  | frr227-PASS.yaml |
  | frr228-FAIL.yaml |
  | frr228-PASS.yaml |
  | frr229-FAIL.yaml |
  | frr229-PASS.yaml |
  | frr230-FAIL.yaml |
  | frr230-PASS.yaml |
  | frr231-FAIL.yaml |
  | frr231-PASS.yaml |
  | frr232-FAIL.yaml |
  | frr232-PASS.yaml |
  | frr233-FAIL.yaml |
  | frr233-PASS.yaml |
  | frr234-FAIL.yaml |
  | frr234-PASS.yaml |
  | frr235-FAIL.yaml |
  | frr235-PASS.yaml |
  | frr236-FAIL.yaml |
  | frr236-PASS.yaml |
  | frr237-FAIL.yaml |
  | frr237-PASS.yaml |
  | frr238-FAIL.yaml |
  | frr238-PASS.yaml |
  | frr239-FAIL.yaml |
  | frr239-PASS.yaml |
  | frr240-FAIL.yaml |
  | frr240-PASS.yaml |
  | frr241-FAIL.yaml |
  | frr241-PASS.yaml |
  | frr242-FAIL.yaml |
  | frr242-PASS.yaml |
  | frr243-FAIL.yaml |
  | frr243-PASS.yaml |
  | frr244-FAIL.yaml |
  | frr244-PASS.yaml |
  | frr245-FAIL.yaml |
  | frr245-PASS.yaml |
  | frr246-FAIL.yaml |
  | frr246-PASS.yaml |
  | frr247-FAIL.yaml |
  | frr247-PASS.yaml |
  | frr248-FAIL.yaml |
  | frr248-PASS.yaml |
  | frr249-FAIL.yaml |
  | frr249-PASS.yaml |
  | frr250-FAIL.yaml |
  | frr250-PASS.yaml |
  | frr251-FAIL.yaml |
  | frr251-PASS.yaml |
  | frr252-FAIL.yaml |
  | frr252-PASS.yaml |
  | frr253-FAIL.yaml |
  | frr253-PASS.yaml |
  | frr254-FAIL.yaml |
  | frr254-PASS.yaml |
  | frr255-FAIL.yaml |
  | frr255-PASS.yaml |
  | frr256-FAIL.yaml |
  | frr256-PASS.yaml |
  | frr257-FAIL.yaml |
  | frr257-PASS.yaml |
  | frr258-FAIL.yaml |
  | frr258-PASS.yaml |
  | frr259-FAIL.yaml |
  | frr259-PASS.yaml |
  | frr260-FAIL.yaml |
  | frr260-PASS.yaml |
  | frr261-FAIL.yaml |
  | frr261-PASS.yaml |
  | frr262-FAIL.yaml |
  | frr262-PASS.yaml |
  | frr263-FAIL.yaml |
  | frr263-PASS.yaml |
  | frr264-FAIL.yaml |
  | frr264-PASS.yaml |
  | frr265-FAIL.yaml |
  | frr265-PASS.yaml |
  | frr266-FAIL.yaml |
  | frr266-PASS.yaml |
  | frr267-FAIL.yaml |
  | frr267-PASS.yaml |
  | frr268-FAIL.yaml |
  | frr268-PASS.yaml |
  | frr269-FAIL.yaml |
  | frr269-PASS.yaml |
  | frr270-FAIL.yaml |
  | frr270-PASS.yaml |
  | frr271-FAIL.yaml |
  | frr271-PASS.yaml |
  | frr272-FAIL.yaml |
  | frr272-PASS.yaml |
  | frr273-FAIL.yaml |
  | frr273-PASS.yaml |
  | frr274-FAIL.yaml |
  | frr274-PASS.yaml |
  | frr275-FAIL.yaml |
  | frr275-PASS.yaml |
  | frr276-FAIL.yaml |
  | frr276-PASS.yaml |
  | frr277-FAIL.yaml |
  | frr277-PASS.yaml |
  | frr278-FAIL.yaml |
  | frr278-PASS.yaml |
  | frr279-FAIL.yaml |
  | frr279-PASS.yaml |
  | frr280-FAIL.yaml |
  | frr280-PASS.yaml |
  | frr281-FAIL.yaml |
  | frr281-PASS.yaml |
  | frr282-FAIL.yaml |
  | frr282-PASS.yaml |
  | frr283-FAIL.yaml |
  | frr283-PASS.yaml |
  | frr284-FAIL.yaml |
  | frr284-PASS.yaml |
  | frr285-FAIL.yaml |
  | frr285-PASS.yaml |
  | frr286-FAIL.yaml |
  | frr286-PASS.yaml |
  | frr287-FAIL.yaml |
  | frr287-PASS.yaml |
  | frr288-FAIL.yaml |
  | frr288-PASS.yaml |
  | frr289-FAIL.yaml |
  | frr289-PASS.yaml |
  | frr290-FAIL.yaml |
  | frr290-PASS.yaml |
  | frr291-FAIL.yaml |
  | frr291-PASS.yaml |
  | frr292-FAIL.yaml |
  | frr292-PASS.yaml |
  | frr293-FAIL.yaml |
  | frr293-PASS.yaml |
  | frr294-FAIL.yaml |
  | frr294-PASS.yaml |
  | frr296-FAIL.yaml |
  | frr296-PASS.yaml |
  | frr297-FAIL.yaml |
  | frr297-PASS.yaml |
  | frr298-FAIL.yaml |
  | frr298-PASS.yaml |
  | frr299-FAIL.yaml |
  | frr299-PASS.yaml |
  | frr300-FAIL.yaml |
  | frr300-PASS.yaml |
  | frr301-FAIL.yaml |
  | frr301-PASS.yaml |
  | frr302-FAIL.yaml |
  | frr302-PASS.yaml |
  | frr303-FAIL.yaml |
  | frr303-PASS.yaml |
  | frr304-FAIL.yaml |
  | frr304-PASS.yaml |
  | frr305-FAIL.yaml |
  | frr305-PASS.yaml |
  | frr306-FAIL.yaml |
  | frr306-PASS.yaml |
  | frr307-FAIL.yaml |
  | frr307-PASS.yaml |
#END_DYNAMIC_TEST_CASES

@style-guide
Scenario: Validating content line length constraints
  Then I should verify that all invalid sample content is smaller than 100 lines